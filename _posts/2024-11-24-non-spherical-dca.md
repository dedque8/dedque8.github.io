---
layout: post
title:  "Non-spherical DCA in non-vacuum environment"
date:   2024-11-25 00:00:00
categories: finance
image: sponge_dca.jpg
---

DCA or dollar-cost averaging is likely the most used investment strategy (except gambling) if you push it to certain extremums. For example, decrease the number of time periods to 1, or push period length to infinity. But back to common usage, let's start with the definition generated by Claude:

> Dollar-cost averaging is an investment strategy where you invest a fixed amount of money at regular intervals (like weekly or monthly), regardless of the asset's price. This approach helps reduce the impact of price volatility since you buy more shares when prices are low and fewer shares when prices are high.

This makes a lot of sense in theory, but in practice the benefits are not so obvious. Multiple [research papers](https://www.researchgate.net/publication/283226036_Dollar_Cost_Averaging_vs_Lump_Sum_Evidence_from_investing_simulations_on_real_data) and [reputable bloggers](https://youtu.be/KwR3nxojS0g?si=fBaFb37DOAg_9uFh) claim it to be suboptimal. However, most of them (to my knowledge) fail to:
- Consider transaction costs
- Consider temporary money allocation
- Compare risk-adjusted returns 

I don't expect them to be completely wrong, but their proofs and experiments are not convincing enough for me. Let's try to do non-spherical dollar-cost averaging in a non-vacuum environment.

## Glossary

LS - Lump Sum Strategy  

DCA - Dollar-Cost Averaging Strategy  

TDCA - Treasury Dollar-Cost Averaging Strategy (defined later)  

## Baseline comparison

For baseline comparison let's take these parameters:
- Starting sum: $12,000
- Time frame: Jan 1988 to Nov 2023
- Frequency: one sample for each market day
- DCA: 12 periods of 21 trading days each (mean number of trading days in a calendar month)
- Price: mean between daily open and close prices
- What to compare: capital gain/loss after 252 trading days

After running a simulation, we achieve the following mean gain/loss:
```
LS mean: 0.12319620744021288
DCA mean: 0.06466051809415665
```
Note that LS's mean 12% per year accounts for dividends, but does not account for inflation, commissions, and fund fees, so it's naturally more than what is considered expected stock market return. Also recent time frame in general has better returns than early and mid-1900s. And speaking about best/worst results, here they are:
```
LS best: 0.7630732830895225
LS worst: -0.4750431388398049
DCA best: 0.28856797082913166
DCA worst: -0.40876185101150736
```
If you were very lucky, you could get 75% gain over one year, or lose 47% if you were not so lucky. DCA expectedly smooths these numbers, but so far, our results confirm claims of suboptimality.

## Risk-adjustment

It's nice to think about statistically expected return on investment, but risk is a way too important factor. Losing 47% on salary leftovers is bad, but losing 47% on inheritance or a lottery win can be soul-crushing. To factor the risk in, let's calculate Sharpe ratios for both strategies taking 0 as a baseline return:
```
LS sharpe: 0.7557245133631939
DCA sharpe: 0.6928429996285987
```
Dollar-cost averaging still loses against lump sum, however not as badly as the mean return does.

## Transaction costs

To make the situation more realistic, we need to consider transaction fees. Some brokers allow to trade popular stocks and ETFs without commission, but let's take 1$ as base buy/sell transaction fee. Expectedly, it doesn't affect LS performance, as it requires only one transaction to be completed. DCA is a bit more affected by transaction fees, but I'll skip it in favor of more advanced DCA-based strategy.

## Fixed-income waiting

One of the most obvious arguments against dollar-cost averaging is the fact that part of the money just waits in one's pocket, losing on market returns and deteriorating due to inflation. This is a valid problem and it can be fixed by utilizing low-risk fixed income instruments, such as short-term treasury bonds.
Formally, the TDCA strategy can be formulated this way:
- Assume initial capital allocation of 100% bonds + 0% stocks
- In equal time periods re-allocate equal funds into stocks

In our case, we'll start with buying 1/12 of stocks and 11/12 of treasury bond ETFs (e.g. SGOV) and re-balance 1/12 from bonds to stocks every 21 trading days. This will also cause x2 more transaction fees. Results are as follows:
```
LS mean: 0.12319620744021288
DCA mean: 0.06466051809415665
TDCA mean: 0.07608127440547507

LS sharpe: 0.7557245133631939
DCA sharpe: 0.6928429996285987
TDCA sharpe: 0.7858485061890712
```
Expected gains have increased by 1% of the starting capital (compared to simple DCA), but are still lower than using LS. However, the Sharpe ratio is now better than LS's. This can be explained by visualizing returns distributions:

![graph1](https://eknm-hub-public.s3.eu-central-1.amazonaws.com/ls-vs-dca/graph1.png)

Lower TDCA variance reduces the risk and increases Sharpe's ratio.

## Minimal viable starting sum

TDCA is the most transaction-intense strategy out of three, so let's try to measure the effect of transaction fees starting from $100:

![graph2](https://eknm-hub-public.s3.eu-central-1.amazonaws.com/ls-vs-dca/graph2.png)

So, assuming 1$ transaction fees, it only makes sense to use TDCA if you plan to invest 5-digit sums (NOT FINANCIAL ADVICE!!!). And also not a practical rule, more a demonstration of how even small fees can skew profitability of a strategy.

### Math is not real life

While it does not mathematically make sense to use DCA to maximize profits, there are certain situations and reasons when it is the most sound strategy, for example:
- Regular investments from income (you can't invest a lump sum if you don't have it)
- Regret minimization (mental health is as important as financial, if not more)

## Forecasting a winner

So now we have two strategies that may outperform each other depending on the situation. Can we predict which of them is better for any given starting day? Before trying, let's plot the historical performance of LS vs TDCA:

![graph2](https://eknm-hub-public.s3.eu-central-1.amazonaws.com/ls-vs-dca/graph3.png)

We see long periods of LS underperformance in 1990, 2000, 2008 and 2021, which are the periods of the falling/stagnating stock market. Indeed, it correlates with stock market returns, as the more it grows, the more returns TDCA misses out on. So it's basically the same as predicting stock market moves, and this is definitely out of scope of this article.
